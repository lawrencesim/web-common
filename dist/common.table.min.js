!function(e,t){"object"==typeof module&&module.exports?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):e.CommonTable=t(e.$)}(this,function(e){function t(t,r,a){return this.tableData=null,this.hdrGroups=[],this.headerObjs=[],this.headerElems=[],this.tableElement=e("<table>",{class:"cm-table"}),this.tbodyElement=e("<tbody>").appendTo(this.tableElement),a&&this.tableElement.appendTo(a),t&&this.tableElement.attr("id",t),r&&this.tableElement.attr("class",r),this}return t.prototype.appendTo=function(e){return this.tableElement.appendTo(e),this},t.prototype.prependTo=function(e){return this.tableElement.prependTo(e),this},t.prototype.addColumn=function(e,t,r,a){return e&&e.hasOwnProperty("title")&&e.hasOwnProperty("key")&&!t&&!r?(e.group||(e.group=null),this.headerObjs.push(e)):(e||(e=null),a||(a={}),this.headerObjs.push({group:e,title:t,key:r,format:a.format,dateFormat:a.dateFormat,hdrStyles:a.hdrStyles,colStyles:a.colStyles,onClick:a.onClick,sortable:void 0===a.sortable||a.sortable})),this},t.prototype.createHeaders=function(t,r){var a=this;this.tbodyElement.html("");for(var o=[e("<tr>",{"cm-table-rowtype":"header-row"}).appendTo(this.tbodyElement),e("<tr>",{"cm-table-rowtype":"header-row"}).appendTo(this.tbodyElement)],s=null,l=null,n=0;n<this.headerObjs.length;n++){var i=this.headerObjs[n];i.group&&(s&&i.group===s?l.attr("colspan",1+parseInt(l.attr("colspan"))):(s=i.group,l=e("<th>",{html:i.group,style:"text-align:center;",colspan:1,"cm-table-celltype":"header-group"}).appendTo(o[0])));var h=e("<th>",{html:i.title,"cm-table-celltype":"header"}),p={};if(i.colStyles)for(var d in i.colStyles)p[d]=i.colStyles[d];if(i.hdrStyles)for(var d in i.hdrStyles)p[d]=i.hdrStyles[d];h.css(p);var c=t&&t===i.key;c&&h.append(e("<i>",{class:"icon-"+(r?"ascending":"descending")})),i.sortable&&h.css("cursor","pointer").on("click",function(e,t){return function(r){r.stopPropagation(),a.populateTable(null,e,t)}}(i.key,!c||!r)),i.group?o[1].append(h):(h.attr("rowspan",2),o[0].append(h))}return o[1][0].hasChildNodes()||(o[1].remove(),o[0].find("th").attr("rowspan",1)),this},t.prototype.populateTable=function(t,r,a,o){this.createHeaders(r,a),t&&(this.tableData=t);var s=this.tableData;if(r&&s.length){var s=this.tableData.slice();s.sort(function(e,t){var o=0,s=[e[r],t[r]],l=[void 0===s[0],void 0===s[1]];if(l[0]!==l[1])o=l[0]?-1:1;else if(!l[0])if("number"==typeof s[0]&&"number"==typeof s[1])o=s[0]-s[1];else{var n=[Date.parse(s[0]),Date.parse(s[1])];o=isNaN(n[0])||isNaN(n[0])?s[0].localeCompare(s[1]):n[0]-n[1]}return a?o:-o})}for(var l=0;l<s.length;l++)for(var n=e("<tr>",{"cm-table-rowtype":"data"}).appendTo(this.tbodyElement),i=0;i<this.headerObjs.length;i++){var h=s[l][this.headerObjs[i].key];if(this.headerObjs[i].format)h=this.headerObjs[i].format(h);else if(this.headerObjs[i].dateFormat)try{h=o(h,this.headerObjs[i].dateFormat)}catch(e){}var p=e("<td>",{"cm-table-celltype":"data"}).appendTo(n);this.headerObjs[i].colStyles&&p.css(this.headerObjs[i].colStyles),this.headerObjs[i].onClick?e("<a>",{href:"#",html:h}).appendTo(p).on("click",function(e,t){return function(r){e(t),r.preventDefault()}}(this.headerObjs[i].onClick,s[l])):p.html(h)}return this},t});